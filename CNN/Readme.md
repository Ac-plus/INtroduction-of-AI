# 卷积神经网络实现手写数字识别

## 一、实验内容
LeNet-5模型是Yann LeCun教授在论文Gradient-Based Learning Applied to Document Recognition中提出的，它是第一个成功应用于数字识别问题的卷积神经网络，如图1-1所示。在MNIST数据集上，LeNet-5模型可以达到大约99.2%的正确率。
本实验需要使用LeNet-5模型，通过编写代码并导入MNIST数据集进行训练和测试，实现对手写数字的识别，并分析实验结果的正确性。

## 二、实验原理与步骤

作为一种分层的卷积神经网络结构，LeNet-5的层次结构如表1所示。其中一共有7层（不包含输入），每层都包含可训练参数。为了使得潜在的明显特征（如笔画断点或角）能够出现在最高层特征检测子感受野（receptive field）的中心，输入图像大小应为32*32，比MNIST数据集的图片要稍大一些。因此在训练整个网络之前，需要对28*28的图像的周围填充0。

![image](https://github.com/Ac-plus/INtroduction-of-AI/assets/104805387/ee24209a-013e-4f5c-8a15-4df462fc0ef9)

本实验的具体步骤如下：

（1）配置实验环境；

（2）分析问题需求；

（3）设计Lenet-5的数字识别算法，画出流程图，分析伪代码；

（4）根据流程图编写完整程序；

（5）分析实验结果。

## 三、实验结果与分析
### 3.1 网络结构与参数信息
如图3-1所示，编译运行train程序，完成网络模拟，运行结果如下。

![image](https://github.com/Ac-plus/INtroduction-of-AI/assets/104805387/13b0ae53-5e5d-4444-ab1d-8ae51515eef8)

图3-1 网络结构与参数信息

图3-1中第一列为网络层名称，第二列为输出的维度，第三列为参数的值。可见本实验的网络层参数符合实验指导文档中的要求。

## 3.2 模型训练结果
使用Tensorflow对模型进行训练，运用的数据集即为图2-2所示的25张数字图片。运行train程序得到的训练结果如图3-2所示。
 
![image](https://github.com/Ac-plus/INtroduction-of-AI/assets/104805387/0d7d7bf9-400f-497b-a55d-fa6e527106f3)

图3-2(b)的结果表明训练成功，即已成功完成30个epoch模型的LeNet-5训练。

## 3.3 模型预测结果
使用可视化模型预测输出的结果，得到前25张图片的可视化模型如图3-3所示，程序给出的识别结果如图3-4(a)所示，调成与原图一样的输出格式即如图3-4(b)所示。
 
![image](https://github.com/Ac-plus/INtroduction-of-AI/assets/104805387/15fb17b0-dd68-4742-be7d-c99742a90056)



### 3.4 结果分析
#### 3.4.1 训练效果分析
图3-2中显示了每个epoch模型训练时的各个指标，由此列出下面的表3，用以初步说明使用LeNet-5卷积神经网络对数字识别模型的训练效果。其中每组即代表图3-2中的1个epoch。

表3 训练数据

|指标|	Training time|	Step lossAccuracy	|Value loss	|Value accuracy |
|---|---|---|---|---|
|30组的平均值|	19.13s|	0.0384|	0.9890	| 0.0902	|0.9832 |

分析如下：

（1）由表可知，经过上述训练，错误率已经很低，识别准确率也已经达到了较高的水平（98%以上）。因此可以初步认为使用LeNet-5神经网络模型训练为有效。

（2）图3-2中的step loss基本都在0.02左右，而30组epoch的平均值却达到了0.03以上，这是因为第一组epoch的step loss比其他组都高，达到了0.3左右，从而导致整体均值偏高。类似的还有accuracy指标，后几组基本都为0.99左右，但第一组却只有0.92左右，所以导致了整体均值偏低。由此推知，LeNet-5的第一次训练所耗费的代价可能会稍大。

#### 3.4.2 测试结果分析
（1）准确性

根据图3-3和图3-4的对比结果，发现这25个数的测试结果与原图基本上全部吻合。唯一有缺陷的地方是图3-3中第5行第3个数字的识别结果。程序将其识别为了“6”，而书写者所写的既有可能是“6”，也有可能是“4”。因此本次识别的准确率应当在96%~100%之间。

（2）局限性

本次实验的结果还受制于数据集的规模。在LeNet-5的实际运用中，如果导入更大规模的训练量和测试数据量，程序应当能够进行更加精准的识别不同的
手写数字。 
综合3.4.1和以上两点所述，本小组认为此次实验使用LeNet-5神经网络模型进行训练与预测是有效的。

#### 3.4.3 模型优缺点
本次实验结束后，也引发了我们对卷积神经网络模型优势与局限性的思考。结合所学知识与LeNet-5手写数字识别的实践，归纳出如表4所示的模型特点：


![image](https://github.com/Ac-plus/INtroduction-of-AI/assets/104805387/55691cc3-5a0d-4b1d-aabb-34498cefb4b4)


## 四、实验总结

本实验中，通过LeNet-5和Tensorflow等方法，实现了对手写数字图片的识别。本小组所编写的程序能够通过对模型进行的卷积训练，对不同的手写数字进行较为精准的识别。综上所述，本次实验大体成功。





